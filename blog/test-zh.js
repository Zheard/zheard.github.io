var jsCrop = (function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b=typeof globalThis!=="undefined"?globalThis:b||self,b.Cropper=a())}(this,(function(){function G(b2){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){G=function(b3){return typeof b3}}else{G=function(b3){return b3&&typeof Symbol==="function"&&b3.constructor===Symbol&&b3!==Symbol.prototype?"symbol":typeof b3}}return G(b2)}function aC(b2,b3){if(!(b2 instanceof b3)){throw new TypeError("Cannot call a class as a function")}}function bM(b5,b3){for(var b2=0;b2<b3.length;b2++){var b4=b3[b2];b4.enumerable=b4.enumerable||false;b4.configurable=true;if("value" in b4){b4.writable=true}Object.defineProperty(b5,b4.key,b4)}}function a8(b4,b2,b3){if(b2){bM(b4.prototype,b2)}if(b3){bM(b4,b3)}return b4}function bi(b4,b2,b3){if(b2 in b4){Object.defineProperty(b4,b2,{value:b3,enumerable:true,configurable:true,writable:true})}else{b4[b2]=b3}return b4}function bI(b3,b4){var b5=Object.keys(b3);if(Object.getOwnPropertySymbols){var b2=Object.getOwnPropertySymbols(b3);if(b4){b2=b2.filter(function(b6){return Object.getOwnPropertyDescriptor(b3,b6).enumerable})}b5.push.apply(b5,b2)}return b5}function bW(b4){for(var b2=1;b2<arguments.length;b2++){var b3=arguments[b2]!=null?arguments[b2]:{};if(b2%2){bI(Object(b3),true).forEach(function(b5){bi(b4,b5,b3[b5])})}else{if(Object.getOwnPropertyDescriptors){Object.defineProperties(b4,Object.getOwnPropertyDescriptors(b3))}else{bI(Object(b3)).forEach(function(b5){Object.defineProperty(b4,b5,Object.getOwnPropertyDescriptor(b3,b5))})}}}return b4}function an(b2){return aH(b2)||av(b2)||aZ(b2)||q()}function aH(b2){if(Array.isArray(b2)){return be(b2)}}function av(b2){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(b2)){return Array.from(b2)}}function aZ(b3,b2){if(!b3){return}if(typeof b3==="string"){return be(b3,b2)}var b4=Object.prototype.toString.call(b3).slice(8,-1);if(b4==="Object"&&b3.constructor){b4=b3.constructor.name}if(b4==="Map"||b4==="Set"){return Array.from(b3)}if(b4==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b4)){return be(b3,b2)}}function be(b3,b2){if(b2==null||b2>b3.length){b2=b3.length}for(var b5=0,b4=new Array(b2);b5<b2;b5++){b4[b5]=b3[b5]}return b4}function q(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h=typeof window!=="undefined"&&typeof window.document!=="undefined";var aw=h?window:{};var P=h&&aw.document.documentElement?"ontouchstart" in aw.document.documentElement:false;var bz=h?"PointerEvent" in aw:false;var M="cropper";var ae="all";var bd="crop";var bK="move";var F="zoom";var ay="e";var X="w";var b="s";var bV="n";var a0="ne";var aD="nw";var e="se";var bL="sw";var bA="".concat(M,"-crop");var f="".concat(M,"-disabled");var g="".concat(M,"-hidden");var aj="".concat(M,"-hide");var ai="".concat(M,"-invisible");var bo="".concat(M,"-modal");var bZ="".concat(M,"-move");var bp="".concat(M,"Action");var a2="".concat(M,"Preview");var aq="crop";var aO="move";var at="none";var bO="crop";var aY="cropend";var bT="cropmove";var D="cropstart";var bP="dblclick";var bn=P?"touchstart":"mousedown";var bh=P?"touchmove":"mousemove";var I=P?"touchend touchcancel":"mouseup";var bw=bz?"pointerdown":bn;var bG=bz?"pointermove":bh;var bQ=bz?"pointerup pointercancel":I;var ak="ready";var az="resize";var aL="wheel";var ap="zoom";var aJ="image/jpeg";var S=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;var a9=/^data:/;var bF=/^data:image\/jpeg;base64,/;var ba=/^img|canvas$/i;var C=200;var aG=100;var V={viewMode:0,dragMode:aq,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:C,minContainerHeight:aG,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var al='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var aI=Number.isNaN||aw.isNaN;function af(b2){return typeof b2==="number"&&!aI(b2)}var bC=function bC(b2){return b2>0&&b2<Infinity};function aP(b2){return typeof b2==="undefined"}function bY(b2){return G(b2)==="object"&&b2!==null}var J=Object.prototype.hasOwnProperty;function w(b4){if(!bY(b4)){return false}try{var b5=b4.constructor;var b3=b5.prototype;return b5&&b3&&J.call(b3,"isPrototypeOf")}catch(b2){return false}}function n(b2){return typeof b2==="function"}var B=Array.prototype.slice;function s(b2){return Array.from?Array.from(b2):B.call(b2)}function ar(b2,b3){if(b2&&n(b3)){if(Array.isArray(b2)||af(b2.length)){s(b2).forEach(function(b5,b4){b3.call(b2,b5,b4,b2)})}else{if(bY(b2)){Object.keys(b2).forEach(function(b4){b3.call(b2,b2[b4],b4,b2)})}}}return b2}var ag=Object.assign||function ag(b5){for(var b2=arguments.length,b3=new Array(b2>1?b2-1:0),b4=1;b4<b2;b4++){b3[b4-1]=arguments[b4]}if(bY(b5)&&b3.length>0){b3.forEach(function(b6){if(bY(b6)){Object.keys(b6).forEach(function(b7){b5[b7]=b6[b7]})}})}return b5};var bl=/\.\d*(?:0|9){12}\d*$/;function bq(b2){var b3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100000000000;return bl.test(b2)?Math.round(b2*b3)/b3:b2}var i=/^width|height|left|top|marginLeft|marginTop$/;function T(b2,b4){var b3=b2.style;ar(b4,function(b6,b5){if(i.test(b5)&&af(b6)){b6="".concat(b6,"px")}b3[b5]=b6})}function z(b2,b3){return b2.classList?b2.classList.contains(b3):b2.className.indexOf(b3)>-1}function x(b2,b4){if(!b4){return}if(af(b2.length)){ar(b2,function(b5){x(b5,b4)});return}if(b2.classList){b2.classList.add(b4);return}var b3=b2.className.trim();if(!b3){b2.className=b4}else{if(b3.indexOf(b4)<0){b2.className="".concat(b3," ").concat(b4)}}}function a5(b2,b3){if(!b3){return}if(af(b2.length)){ar(b2,function(b4){a5(b4,b3)});return}if(b2.classList){b2.classList.remove(b3);return}if(b2.className.indexOf(b3)>=0){b2.className=b2.className.replace(b3,"")}}function a3(b2,b4,b3){if(!b4){return}if(af(b2.length)){ar(b2,function(b5){a3(b5,b4,b3)});return}if(b3){x(b2,b4)}else{a5(b2,b4)}}var u=/([a-z\d])([A-Z])/g;function aA(b2){return b2.replace(u,"$1-$2").toLowerCase()}function bg(b3,b2){if(bY(b3[b2])){return b3[b2]}if(b3.dataset){return b3.dataset[b2]}return b3.getAttribute("data-".concat(aA(b2)))}function au(b3,b2,b4){if(bY(b4)){b3[b2]=b4}else{if(b3.dataset){b3.dataset[b2]=b4}else{b3.setAttribute("data-".concat(aA(b2)),b4)}}}function p(b4,b3){if(bY(b4[b3])){try{delete b4[b3]}catch(b2){b4[b3]=undefined}}else{if(b4.dataset){try{delete b4.dataset[b3]}catch(b2){b4.dataset[b3]=undefined}}else{b4.removeAttribute("data-".concat(aA(b3)))}}}var H=/\s\s*/;var aK=function(){var b2=false;if(h){var b5=false;var b6=function b6(){};var b4=Object.defineProperty({},"once",{get:function b3(){b2=true;return b5},set:function b7(b8){b5=b8}});aw.addEventListener("test",b6,b4);aw.removeEventListener("test",b6,b4)}return b2}();function j(b3,b5,b6){var b2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var b4=b6;b5.trim().split(H).forEach(function(b8){if(!aK){var b7=b3.listeners;if(b7&&b7[b8]&&b7[b8][b6]){b4=b7[b8][b6];delete b7[b8][b6];if(Object.keys(b7[b8]).length===0){delete b7[b8]}if(Object.keys(b7).length===0){delete b3.listeners}}}b3.removeEventListener(b8,b4,b2)})}function bv(b4,b5,b6){var b3=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var b2=b6;b5.trim().split(H).forEach(function(ca){if(b3.once&&!aK){var b7=b4.listeners,b9=b7===void 0?{}:b7;b2=function b8(){delete b9[ca][b6];b4.removeEventListener(ca,b2,b3);for(var cb=arguments.length,cd=new Array(cb),cc=0;cc<cb;cc++){cd[cc]=arguments[cc]}b6.apply(b4,cd)};if(!b9[ca]){b9[ca]={}}if(b9[ca][b6]){b4.removeEventListener(ca,b9[ca][b6],b3)}b9[ca][b6]=b2;b4.listeners=b9}b4.addEventListener(ca,b2,b3)})}function aT(b2,b3,b5){var b4;if(n(Event)&&n(CustomEvent)){b4=new CustomEvent(b3,{detail:b5,bubbles:true,cancelable:true})}else{b4=document.createEvent("CustomEvent");b4.initCustomEvent(b3,true,true,b5)}return b2.dispatchEvent(b4)}function bX(b2){var b3=b2.getBoundingClientRect();return{left:b3.left+(window.pageXOffset-document.documentElement.clientLeft),top:b3.top+(window.pageYOffset-document.documentElement.clientTop)}}var aM=aw.location;var aQ=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function bk(b2){var b3=b2.match(aQ);return b3!==null&&(b3[1]!==aM.protocol||b3[2]!==aM.hostname||b3[3]!==aM.port)}function bR(b2){var b3="timestamp=".concat(new Date().getTime());return b2+(b2.indexOf("?")===-1?"?":"&")+b3}function K(b7){var b6=b7.rotate,b5=b7.scaleX,b3=b7.scaleY,b9=b7.translateX,b8=b7.translateY;var b2=[];if(af(b9)&&b9!==0){b2.push("translateX(".concat(b9,"px)"))}if(af(b8)&&b8!==0){b2.push("translateY(".concat(b8,"px)"))}if(af(b6)&&b6!==0){b2.push("rotate(".concat(b6,"deg)"))}if(af(b5)&&b5!==1){b2.push("scaleX(".concat(b5,")"))}if(af(b3)&&b3!==1){b2.push("scaleY(".concat(b3,")"))}var b4=b2.length?b2.join(" "):"none";return{WebkitTransform:b4,msTransform:b4,transform:b4}}function bf(b2){var b4=bW({},b2);var b3=0;ar(b2,function(b6,b5){delete b4[b5];ar(b4,function(b7){var b9=Math.abs(b6.startX-b7.startX);var cc=Math.abs(b6.startY-b7.startY);var b8=Math.abs(b6.endX-b7.endX);var ca=Math.abs(b6.endY-b7.endY);var ce=Math.sqrt(b9*b9+cc*cc);var cd=Math.sqrt(b8*b8+ca*ca);var cb=(cd-ce)/ce;if(Math.abs(cb)>Math.abs(b3)){b3=cb}})});return b3}function aB(b6,b5){var b4=b6.pageX,b3=b6.pageY;var b2={endX:b4,endY:b3};return b5?b2:bW({startX:b4,startY:b3},b2)}function bu(b2){var b4=0;var b3=0;var b5=0;ar(b2,function(b8){var b7=b8.startX,b6=b8.startY;b4+=b7;b3+=b6;b5+=1});b4/=b5;b3/=b5;return{pageX:b4,pageY:b3}}function bx(b9){var b6=b9.aspectRatio,b2=b9.height,b5=b9.width;var b4=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"contain";var b8=bC(b5);var b7=bC(b2);if(b8&&b7){var b3=b2*b6;if(b4==="contain"&&b3>b5||b4==="cover"&&b3<b5){b2=b5/b6}else{b5=b2*b6}}else{if(b8){b2=b5/b6}else{if(b7){b5=b2*b6}}}return{width:b5,height:b2}}function bs(b5){var b3=b5.width,ca=b5.height,b6=b5.degree;b6=Math.abs(b6)%180;if(b6===90){return{width:ca,height:b3}}var b4=b6%90*Math.PI/180;var b8=Math.sin(b4);var b9=Math.cos(b4);var b7=b3*b9+ca*b8;var b2=b3*b8+ca*b9;return b6>90?{width:b2,height:b7}:{width:b7,height:b2}}function a6(b5,ca,b9,b7){var cm=ca.aspectRatio,cz=ca.naturalWidth,cu=ca.naturalHeight,ct=ca.rotate,cD=ct===void 0?0:ct,ch=ca.scaleX,cx=ch===void 0?1:ch,cf=ca.scaleY,cw=cf===void 0?1:cf;var co=b9.aspectRatio,b8=b9.naturalWidth,cb=b9.naturalHeight;var cE=b7.fillColor,cG=cE===void 0?"transparent":cE,cy=b7.imageSmoothingEnabled,ce=cy===void 0?true:cy,cp=b7.imageSmoothingQuality,cc=cp===void 0?"low":cp,cr=b7.maxWidth,cn=cr===void 0?Infinity:cr,cA=b7.maxHeight,cC=cA===void 0?Infinity:cA,ck=b7.minWidth,cd=ck===void 0?0:ck,cg=b7.minHeight,cl=cg===void 0?0:cg;var b6=document.createElement("canvas");var cF=b6.getContext("2d");var cB=bx({aspectRatio:co,width:cn,height:cC});var cv=bx({aspectRatio:co,width:cd,height:cl},"cover");var b2=Math.min(cB.width,Math.max(cv.width,b8));var b4=Math.min(cB.height,Math.max(cv.height,cb));var cq=bx({aspectRatio:cm,width:cn,height:cC});var cj=bx({aspectRatio:cm,width:cd,height:cl},"cover");var ci=Math.min(cq.width,Math.max(cj.width,cz));var cs=Math.min(cq.height,Math.max(cj.height,cu));var b3=[-ci/2,-cs/2,ci,cs];b6.width=bq(b2);b6.height=bq(b4);cF.fillStyle=cG;cF.fillRect(0,0,b2,b4);cF.save();cF.translate(b2/2,b4/2);cF.rotate(cD*Math.PI/180);cF.scale(cx,cw);cF.imageSmoothingEnabled=ce;cF.imageSmoothingQuality=cc;cF.drawImage.apply(cF,[b5].concat(an(b3.map(function(cH){return Math.floor(bq(cH))}))));cF.restore();return b6}var r=String.fromCharCode;function O(b5,b6,b3){var b4="";b3+=b6;for(var b2=b6;b2<b3;b2+=1){b4+=r(b5.getUint8(b2))}return b4}var ab=/^data:.*,/;function aF(b5){var b3=b5.replace(ab,"");var b6=atob(b3);var b4=new ArrayBuffer(b6.length);var b2=new Uint8Array(b4);ar(b2,function(b8,b7){b2[b7]=b6.charCodeAt(b7)});return b4}function aa(b3,b4){var b6=[];var b5=8192;var b2=new Uint8Array(b3);while(b2.length>0){b6.push(r.apply(null,s(b2.subarray(0,b5))));b2=b2.subarray(b5)}return"data:".concat(b4,";base64,").concat(btoa(b6.join("")))}function y(b9){var ce=new DataView(b9);var b4;try{var b3;var b8;var ch;if(ce.getUint8(0)===255&&ce.getUint8(1)===216){var b5=ce.byteLength;var b6=2;while(b6+1<b5){if(ce.getUint8(b6)===255&&ce.getUint8(b6+1)===225){b8=b6;break}b6+=1}}if(b8){var cg=b8+4;var cd=b8+10;if(O(ce,cg,4)==="Exif"){var cb=ce.getUint16(cd);b3=cb===18761;if(b3||cb===19789){if(ce.getUint16(cd+2,b3)===42){var b2=ce.getUint32(cd+4,b3);if(b2>=8){ch=cd+b2}}}}}if(ch){var ca=ce.getUint16(ch,b3);var cf;var b7;for(b7=0;b7<ca;b7+=1){cf=ch+b7*12+2;if(ce.getUint16(cf,b3)===274){cf+=8;b4=ce.getUint16(cf,b3);ce.setUint16(cf,1,b3);break}}}}catch(cc){b4=1}return b4}function k(b3){var b5=0;var b4=1;var b2=1;switch(b3){case 2:b4=-1;break;case 3:b5=-180;break;case 4:b2=-1;break;case 5:b5=90;b2=-1;break;case 6:b5=90;break;case 7:b5=90;b4=-1;break;case 8:b5=-90;break}return{rotate:b5,scaleX:b4,scaleY:b2}}var Y={render:function Y(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function br(){var b5=this.element,b4=this.options,b3=this.container,b7=this.cropper;var b6=Number(b4.minContainerWidth);var b8=Number(b4.minContainerHeight);x(b7,g);a5(b5,g);var b2={width:Math.max(b3.offsetWidth,b6>=0?b6:C),height:Math.max(b3.offsetHeight,b8>=0?b8:aG)};this.containerData=b2;T(b7,{width:b2.width,height:b2.height});x(b5,g);a5(b7,g)},initCanvas:function bt(){var b9=this.containerData,b2=this.imageData;var b4=this.options.viewMode;var b3=Math.abs(b2.rotate)%180===90;var b8=b3?b2.naturalHeight:b2.naturalWidth;var ca=b3?b2.naturalWidth:b2.naturalHeight;var cb=b8/ca;var b5=b9.width;var b7=b9.height;if(b9.height*cb>b9.width){if(b4===3){b5=b9.height*cb}else{b7=b9.width/cb}}else{if(b4===3){b7=b9.width/cb}else{b5=b9.height*cb}}var b6={aspectRatio:cb,naturalWidth:b8,naturalHeight:ca,width:b5,height:b7};this.canvasData=b6;this.limited=b4===1||b4===2;this.limitCanvas(true,true);b6.width=Math.min(Math.max(b6.width,b6.minWidth),b6.maxWidth);b6.height=Math.min(Math.max(b6.height,b6.minHeight),b6.maxHeight);b6.left=(b9.width-b6.width)/2;b6.top=(b9.height-b6.height)/2;b6.oldLeft=b6.left;b6.oldTop=b6.top;this.initialCanvasData=ag({},b6)},limitCanvas:function bm(b2,b7){var cf=this.options,b9=this.containerData,b8=this.canvasData,b5=this.cropBoxData;var b6=cf.viewMode;var cd=b8.aspectRatio;var cc=this.cropped&&b5;if(b2){var ce=Number(cf.minCanvasWidth)||0;var ca=Number(cf.minCanvasHeight)||0;if(b6>1){ce=Math.max(ce,b9.width);ca=Math.max(ca,b9.height);if(b6===3){if(ca*cd>ce){ce=ca*cd}else{ca=ce/cd}}}else{if(b6>0){if(ce){ce=Math.max(ce,cc?b5.width:0)}else{if(ca){ca=Math.max(ca,cc?b5.height:0)}else{if(cc){ce=b5.width;ca=b5.height;if(ca*cd>ce){ce=ca*cd}else{ca=ce/cd}}}}}}var b3=bx({aspectRatio:cd,width:ce,height:ca});ce=b3.width;ca=b3.height;b8.minWidth=ce;b8.minHeight=ca;b8.maxWidth=Infinity;b8.maxHeight=Infinity}if(b7){if(b6>(cc?0:1)){var b4=b9.width-b8.width;var cb=b9.height-b8.height;b8.minLeft=Math.min(0,b4);b8.minTop=Math.min(0,cb);b8.maxLeft=Math.max(0,b4);b8.maxTop=Math.max(0,cb);if(cc&&this.limited){b8.minLeft=Math.min(b5.left,b5.left+(b5.width-b8.width));b8.minTop=Math.min(b5.top,b5.top+(b5.height-b8.height));b8.maxLeft=b5.left;b8.maxTop=b5.top;if(b6===2){if(b8.width>=b9.width){b8.minLeft=Math.min(0,b4);b8.maxLeft=Math.max(0,b4)}if(b8.height>=b9.height){b8.minTop=Math.min(0,cb);b8.maxTop=Math.max(0,cb)}}}}else{b8.minLeft=-b8.width;b8.minTop=-b8.height;b8.maxLeft=b9.width;b8.maxTop=b9.height}}},renderCanvas:function bH(b7,b5){var b6=this.canvasData,b2=this.imageData;if(b5){var b4=bs({width:b2.naturalWidth*Math.abs(b2.scaleX||1),height:b2.naturalHeight*Math.abs(b2.scaleY||1),degree:b2.rotate||0}),b8=b4.width,b9=b4.height;var b3=b6.width*(b8/b6.naturalWidth);var ca=b6.height*(b9/b6.naturalHeight);b6.left-=(b3-b6.width)/2;b6.top-=(ca-b6.height)/2;b6.width=b3;b6.height=ca;b6.aspectRatio=b8/b9;b6.naturalWidth=b8;b6.naturalHeight=b9;this.limitCanvas(true,false)}if(b6.width>b6.maxWidth||b6.width<b6.minWidth){b6.left=b6.oldLeft}if(b6.height>b6.maxHeight||b6.height<b6.minHeight){b6.top=b6.oldTop}b6.width=Math.min(Math.max(b6.width,b6.minWidth),b6.maxWidth);b6.height=Math.min(Math.max(b6.height,b6.minHeight),b6.maxHeight);this.limitCanvas(false,true);b6.left=Math.min(Math.max(b6.left,b6.minLeft),b6.maxLeft);b6.top=Math.min(Math.max(b6.top,b6.minTop),b6.maxTop);b6.oldLeft=b6.left;b6.oldTop=b6.top;T(this.canvas,ag({width:b6.width,height:b6.height},K({translateX:b6.left,translateY:b6.top})));this.renderImage(b7);if(this.cropped&&this.limited){this.limitCropBox(true,true)}},renderImage:function bJ(b5){var b3=this.canvasData,b6=this.imageData;var b4=b6.naturalWidth*(b3.width/b3.naturalWidth);var b2=b6.naturalHeight*(b3.height/b3.naturalHeight);ag(b6,{width:b4,height:b2,left:(b3.width-b4)/2,top:(b3.height-b2)/2});T(this.image,ag({width:b6.width,height:b6.height},K(ag({translateX:b6.left,translateY:b6.top},b6))));if(b5){this.output()}},initCropBox:function d(){var b3=this.options,b2=this.canvasData;var b4=b3.aspectRatio||b3.initialAspectRatio;var b6=Number(b3.autoCropArea)||0.8;var b5={width:b2.width,height:b2.height};if(b4){if(b2.height*b4>b2.width){b5.height=b5.width/b4}else{b5.width=b5.height*b4}}this.cropBoxData=b5;this.limitCropBox(true,true);b5.width=Math.min(Math.max(b5.width,b5.minWidth),b5.maxWidth);b5.height=Math.min(Math.max(b5.height,b5.minHeight),b5.maxHeight);b5.width=Math.max(b5.minWidth,b5.width*b6);b5.height=Math.max(b5.minHeight,b5.height*b6);b5.left=b2.left+(b2.width-b5.width)/2;b5.top=b2.top+(b2.height-b5.height)/2;b5.oldLeft=b5.left;b5.oldTop=b5.top;this.initialCropBoxData=ag({},b5)},limitCropBox:function bE(b2,b5){var cd=this.options,b7=this.containerData,b6=this.canvasData,b4=this.cropBoxData,ca=this.limited;var cc=cd.aspectRatio;if(b2){var b3=Number(cd.minCropBoxWidth)||0;var b8=Number(cd.minCropBoxHeight)||0;var b9=ca?Math.min(b7.width,b6.width,b6.width+b6.left,b7.width-b6.left):b7.width;var cb=ca?Math.min(b7.height,b6.height,b6.height+b6.top,b7.height-b6.top):b7.height;b3=Math.min(b3,b7.width);b8=Math.min(b8,b7.height);if(cc){if(b3&&b8){if(b8*cc>b3){b8=b3/cc}else{b3=b8*cc}}else{if(b3){b8=b3/cc}else{if(b8){b3=b8*cc}}}if(cb*cc>b9){cb=b9/cc}else{b9=cb*cc}}b4.minWidth=Math.min(b3,b9);b4.minHeight=Math.min(b8,cb);b4.maxWidth=b9;b4.maxHeight=cb}if(b5){if(ca){b4.minLeft=Math.max(0,b6.left);b4.minTop=Math.max(0,b6.top);b4.maxLeft=Math.min(b7.width,b6.left+b6.width)-b4.width;b4.maxTop=Math.min(b7.height,b6.top+b6.height)-b4.height}else{b4.minLeft=0;b4.minTop=0;b4.maxLeft=b7.width-b4.width;b4.maxTop=b7.height-b4.height}}},renderCropBox:function N(){var b3=this.options,b2=this.containerData,b4=this.cropBoxData;if(b4.width>b4.maxWidth||b4.width<b4.minWidth){b4.left=b4.oldLeft}if(b4.height>b4.maxHeight||b4.height<b4.minHeight){b4.top=b4.oldTop}b4.width=Math.min(Math.max(b4.width,b4.minWidth),b4.maxWidth);b4.height=Math.min(Math.max(b4.height,b4.minHeight),b4.maxHeight);this.limitCropBox(false,true);b4.left=Math.min(Math.max(b4.left,b4.minLeft),b4.maxLeft);b4.top=Math.min(Math.max(b4.top,b4.minTop),b4.maxTop);b4.oldLeft=b4.left;b4.oldTop=b4.top;if(b3.movable&&b3.cropBoxMovable){au(this.face,bp,b4.width>=b2.width&&b4.height>=b2.height?bK:ae)}T(this.cropBox,ag({width:b4.width,height:b4.height},K({translateX:b4.left,translateY:b4.top})));if(this.cropped&&this.limited){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function bU(){this.preview();aT(this.element,bO,this.getData())}};var a={initPreview:function bD(){var b4=this.element,b2=this.crossOrigin;var b8=this.options.preview;var b3=b2?this.crossOriginUrl:this.url;var b7=b4.alt||"The image to preview";var b6=document.createElement("img");if(b2){b6.crossOrigin=b2}b6.src=b3;b6.alt=b7;this.viewBox.appendChild(b6);this.viewBoxImage=b6;if(!b8){return}var b5=b8;if(typeof b8==="string"){b5=b4.ownerDocument.querySelectorAll(b8)}else{if(b8.querySelector){b5=[b8]}}this.previews=b5;ar(b5,function(ca){var b9=document.createElement("img");au(ca,a2,{width:ca.offsetWidth,height:ca.offsetHeight,html:ca.innerHTML});if(b2){b9.crossOrigin=b2}b9.src=b3;b9.alt=b7;b9.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';ca.innerHTML="";ca.appendChild(b9)})},resetPreview:function b1(){ar(this.previews,function(b2){var b3=bg(b2,a2);T(b2,{width:b3.width,height:b3.height});b2.innerHTML=b3.html;p(b2,a2)})},preview:function a(){var b2=this.imageData,b7=this.canvasData,b5=this.cropBoxData;var b3=b5.width,b8=b5.height;var b4=b2.width,ca=b2.height;var b6=b5.left-b7.left-b2.left;var b9=b5.top-b7.top-b2.top;if(!this.cropped||this.disabled){return}T(this.viewBoxImage,ag({width:b4,height:ca},K(ag({translateX:-b6,translateY:-b9},b2))));ar(this.previews,function(cc){var cg=bg(cc,a2);var ch=cg.width;var cf=cg.height;var ce=ch;var cb=cf;var cd=1;if(b3){cd=ch/b3;cb=b8*cd}if(b8&&cb>cf){cd=cf/b8;ce=b3*cd;cb=cf}T(cc,{width:ce,height:cb});T(cc.getElementsByTagName("img")[0],ag({width:b4*cd,height:ca*cd},K(ag({translateX:-b6*cd,translateY:-b9*cd},b2))))})}};var bS={bind:function aS(){var b3=this.element,b2=this.options,b4=this.cropper;if(n(b2.cropstart)){bv(b3,D,b2.cropstart)}if(n(b2.cropmove)){bv(b3,bT,b2.cropmove)}if(n(b2.cropend)){bv(b3,aY,b2.cropend)}if(n(b2.crop)){bv(b3,bO,b2.crop)}if(n(b2.zoom)){bv(b3,ap,b2.zoom)}bv(b4,bw,this.onCropStart=this.cropStart.bind(this));if(b2.zoomable&&b2.zoomOnWheel){bv(b4,aL,this.onWheel=this.wheel.bind(this),{passive:false,capture:true})}if(b2.toggleDragModeOnDblclick){bv(b4,bP,this.onDblclick=this.dblclick.bind(this))}bv(b3.ownerDocument,bG,this.onCropMove=this.cropMove.bind(this));bv(b3.ownerDocument,bQ,this.onCropEnd=this.cropEnd.bind(this));if(b2.responsive){bv(window,az,this.onResize=this.resize.bind(this))}},unbind:function bj(){var b3=this.element,b2=this.options,b4=this.cropper;if(n(b2.cropstart)){j(b3,D,b2.cropstart)}if(n(b2.cropmove)){j(b3,bT,b2.cropmove)}if(n(b2.cropend)){j(b3,aY,b2.cropend)}if(n(b2.crop)){j(b3,bO,b2.crop)}if(n(b2.zoom)){j(b3,ap,b2.zoom)}j(b4,bw,this.onCropStart);if(b2.zoomable&&b2.zoomOnWheel){j(b4,aL,this.onWheel,{passive:false,capture:true})}if(b2.toggleDragModeOnDblclick){j(b4,bP,this.onDblclick)}j(b3.ownerDocument,bG,this.onCropMove);j(b3.ownerDocument,bQ,this.onCropEnd);if(b2.responsive){j(window,az,this.onResize)}}};var a4={resize:function A(){if(this.disabled){return}var b5=this.options,b3=this.container,b2=this.containerData;var b6=b3.offsetWidth/b2.width;if(b6!==1||b3.offsetHeight!==b2.height){var b4;var b7;if(b5.restore){b4=this.getCanvasData();b7=this.getCropBoxData()}this.render();if(b5.restore){this.setCanvasData(ar(b4,function(b9,b8){b4[b8]=b9*b6}));this.setCropBoxData(ar(b7,function(b9,b8){b7[b8]=b9*b6}))}}},dblclick:function ah(){if(this.disabled||this.options.dragMode===at){return}this.setDragMode(z(this.dragBox,bA)?aO:aq)},wheel:function l(b3){var b5=this;var b2=Number(this.options.wheelZoomRatio)||0.1;var b4=1;if(this.disabled){return}b3.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){b5.wheeling=false},50);if(b3.deltaY){b4=b3.deltaY>0?1:-1}else{if(b3.wheelDelta){b4=-b3.wheelDelta/120}else{if(b3.detail){b4=b3.detail>0?1:-1}}}this.zoom(-b4*b2,b3)},cropStart:function bc(b6){var b5=b6.buttons,b4=b6.button;if(this.disabled||(b6.type==="mousedown"||b6.type==="pointerdown"&&b6.pointerType==="mouse")&&(af(b5)&&b5!==1||af(b4)&&b4!==0||b6.ctrlKey)){return}var b3=this.options,b2=this.pointers;var b7;if(b6.changedTouches){ar(b6.changedTouches,function(b8){b2[b8.identifier]=aB(b8)})}else{b2[b6.pointerId||0]=aB(b6)}if(Object.keys(b2).length>1&&b3.zoomable&&b3.zoomOnTouch){b7=F}else{b7=bg(b6.target,bp)}if(!S.test(b7)){return}if(aT(this.element,D,{originalEvent:b6,action:b7})===false){return}b6.preventDefault();this.action=b7;this.cropping=false;if(b7===bd){this.cropping=true;x(this.dragBox,bo)}},cropMove:function aW(b3){var b4=this.action;if(this.disabled||!b4){return}var b2=this.pointers;b3.preventDefault();if(aT(this.element,bT,{originalEvent:b3,action:b4})===false){return}if(b3.changedTouches){ar(b3.changedTouches,function(b5){ag(b2[b5.identifier]||{},aB(b5,true))})}else{ag(b2[b3.pointerId||0]||{},aB(b3,true))}this.change(b3)},cropEnd:function by(b3){if(this.disabled){return}var b4=this.action,b2=this.pointers;if(b3.changedTouches){ar(b3.changedTouches,function(b5){delete b2[b5.identifier]})}else{delete b2[b3.pointerId||0]}if(!b4){return}b3.preventDefault();if(!Object.keys(b2).length){this.action=""}if(this.cropping){this.cropping=false;a3(this.dragBox,bo,this.cropped&&this.options.modal)}aT(this.element,aY,{originalEvent:b3,action:b4})}};var aN={change:function aN(cl){var b4=this.options,ca=this.canvasData,b3=this.containerData,cf=this.cropBoxData,b9=this.pointers;var ck=this.action;var b2=b4.aspectRatio;var b5=cf.left,cc=cf.top,ci=cf.width,cd=cf.height;var co=b5+ci;var b7=cc+cd;var ce=0;var b8=0;var cm=b3.width;var ch=b3.height;var cg=true;var b6;if(!b2&&cl.shiftKey){b2=ci&&cd?ci/cd:1}if(this.limited){ce=cf.minLeft;b8=cf.minTop;cm=ce+Math.min(b3.width,ca.width,ca.left+ca.width);ch=b8+Math.min(b3.height,ca.height,ca.top+ca.height)}var cj=b9[Object.keys(b9)[0]];var cb={x:cj.endX-cj.startX,y:cj.endY-cj.startY};var cn=function cn(cp){switch(cp){case ay:if(co+cb.x>cm){cb.x=cm-co}break;case X:if(b5+cb.x<ce){cb.x=ce-b5}break;case bV:if(cc+cb.y<b8){cb.y=b8-cc}break;case b:if(b7+cb.y>ch){cb.y=ch-b7}break}};switch(ck){case ae:b5+=cb.x;cc+=cb.y;break;case ay:if(cb.x>=0&&(co>=cm||b2&&(cc<=b8||b7>=ch))){cg=false;break}cn(ay);ci+=cb.x;if(ci<0){ck=X;ci=-ci;b5-=ci}if(b2){cd=ci/b2;cc+=(cf.height-cd)/2}break;case bV:if(cb.y<=0&&(cc<=b8||b2&&(b5<=ce||co>=cm))){cg=false;break}cn(bV);cd-=cb.y;cc+=cb.y;if(cd<0){ck=b;cd=-cd;cc-=cd}if(b2){ci=cd*b2;b5+=(cf.width-ci)/2}break;case X:if(cb.x<=0&&(b5<=ce||b2&&(cc<=b8||b7>=ch))){cg=false;break}cn(X);ci-=cb.x;b5+=cb.x;if(ci<0){ck=ay;ci=-ci;b5-=ci}if(b2){cd=ci/b2;cc+=(cf.height-cd)/2}break;case b:if(cb.y>=0&&(b7>=ch||b2&&(b5<=ce||co>=cm))){cg=false;break}cn(b);cd+=cb.y;if(cd<0){ck=bV;cd=-cd;cc-=cd}if(b2){ci=cd*b2;b5+=(cf.width-ci)/2}break;case a0:if(b2){if(cb.y<=0&&(cc<=b8||co>=cm)){cg=false;break}cn(bV);cd-=cb.y;cc+=cb.y;ci=cd*b2}else{cn(bV);cn(ay);if(cb.x>=0){if(co<cm){ci+=cb.x}else{if(cb.y<=0&&cc<=b8){cg=false}}}else{ci+=cb.x}if(cb.y<=0){if(cc>b8){cd-=cb.y;cc+=cb.y}}else{cd-=cb.y;cc+=cb.y}}if(ci<0&&cd<0){ck=bL;cd=-cd;ci=-ci;cc-=cd;b5-=ci}else{if(ci<0){ck=aD;ci=-ci;b5-=ci}else{if(cd<0){ck=e;cd=-cd;cc-=cd}}}break;case aD:if(b2){if(cb.y<=0&&(cc<=b8||b5<=ce)){cg=false;break}cn(bV);cd-=cb.y;cc+=cb.y;ci=cd*b2;b5+=cf.width-ci}else{cn(bV);cn(X);if(cb.x<=0){if(b5>ce){ci-=cb.x;b5+=cb.x}else{if(cb.y<=0&&cc<=b8){cg=false}}}else{ci-=cb.x;b5+=cb.x}if(cb.y<=0){if(cc>b8){cd-=cb.y;cc+=cb.y}}else{cd-=cb.y;cc+=cb.y}}if(ci<0&&cd<0){ck=e;cd=-cd;ci=-ci;cc-=cd;b5-=ci}else{if(ci<0){ck=a0;ci=-ci;b5-=ci}else{if(cd<0){ck=bL;cd=-cd;cc-=cd}}}break;case bL:if(b2){if(cb.x<=0&&(b5<=ce||b7>=ch)){cg=false;break}cn(X);ci-=cb.x;b5+=cb.x;cd=ci/b2}else{cn(b);cn(X);if(cb.x<=0){if(b5>ce){ci-=cb.x;b5+=cb.x}else{if(cb.y>=0&&b7>=ch){cg=false}}}else{ci-=cb.x;b5+=cb.x}if(cb.y>=0){if(b7<ch){cd+=cb.y}}else{cd+=cb.y}}if(ci<0&&cd<0){ck=a0;cd=-cd;ci=-ci;cc-=cd;b5-=ci}else{if(ci<0){ck=e;ci=-ci;b5-=ci}else{if(cd<0){ck=aD;cd=-cd;cc-=cd}}}break;case e:if(b2){if(cb.x>=0&&(co>=cm||b7>=ch)){cg=false;break}cn(ay);ci+=cb.x;cd=ci/b2}else{cn(b);cn(ay);if(cb.x>=0){if(co<cm){ci+=cb.x}else{if(cb.y>=0&&b7>=ch){cg=false}}}else{ci+=cb.x}if(cb.y>=0){if(b7<ch){cd+=cb.y}}else{cd+=cb.y}}if(ci<0&&cd<0){ck=aD;cd=-cd;ci=-ci;cc-=cd;b5-=ci}else{if(ci<0){ck=bL;ci=-ci;b5-=ci}else{if(cd<0){ck=a0;cd=-cd;cc-=cd}}}break;case bK:this.move(cb.x,cb.y);cg=false;break;case F:this.zoom(bf(b9),cl);cg=false;break;case bd:if(!cb.x||!cb.y){cg=false;break}b6=bX(this.cropper);b5=cj.startX-b6.left;cc=cj.startY-b6.top;ci=cf.minWidth;cd=cf.minHeight;if(cb.x>0){ck=cb.y>0?e:a0}else{if(cb.x<0){b5-=ci;ck=cb.y>0?bL:aD}}if(cb.y<0){cc-=cd}if(!this.cropped){a5(this.cropBox,g);this.cropped=true;if(this.limited){this.limitCropBox(true,true)}}break}if(cg){cf.width=ci;cf.height=cd;cf.left=b5;cf.top=cc;this.action=ck;this.renderCropBox()}ar(b9,function(cp){cp.startX=cp.endX;cp.startY=cp.endY})}};var ax={crop:function o(){if(this.ready&&!this.cropped&&!this.disabled){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){x(this.dragBox,bo)}a5(this.cropBox,g);this.setCropBoxData(this.initialCropBoxData)}return this},reset:function bb(){if(this.ready&&!this.disabled){this.imageData=ag({},this.initialImageData);this.canvasData=ag({},this.initialCanvasData);this.cropBoxData=ag({},this.initialCropBoxData);this.renderCanvas();if(this.cropped){this.renderCropBox()}}return this},clear:function bN(){if(this.cropped&&!this.disabled){ag(this.cropBoxData,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();a5(this.dragBox,bo);x(this.cropBox,g)}return this},replace:function aV(b3){var b2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.disabled&&b3){if(this.isImg){this.element.src=b3}if(b2){this.url=b3;this.image.src=b3;if(this.ready){this.viewBoxImage.src=b3;ar(this.previews,function(b4){b4.getElementsByTagName("img")[0].src=b3})}}else{if(this.isImg){this.replaced=true}this.options.data=null;this.uncreate();this.load(b3)}}return this},enable:function m(){if(this.ready&&this.disabled){this.disabled=false;a5(this.cropper,f)}return this},disable:function aE(){if(this.ready&&!this.disabled){this.disabled=true;x(this.cropper,f)}return this},destroy:function t(){var b2=this.element;if(!b2[M]){return this}b2[M]=undefined;if(this.isImg&&this.replaced){b2.src=this.originalUrl}this.uncreate();return this},move:function L(b2){var b6=arguments.length>1&&arguments[1]!==undefined?arguments[1]:b2;var b3=this.canvasData,b5=b3.left,b4=b3.top;return this.moveTo(aP(b2)?b2:b5+Number(b2),aP(b6)?b6:b4+Number(b6))},moveTo:function bB(b2){var b5=arguments.length>1&&arguments[1]!==undefined?arguments[1]:b2;var b3=this.canvasData;var b4=false;b2=Number(b2);b5=Number(b5);if(this.ready&&!this.disabled&&this.options.movable){if(af(b2)){b3.left=b2;b4=true}if(af(b5)){b3.top=b5;b4=true}if(b4){this.renderCanvas(true)}}return this},zoom:function a1(b4,b2){var b3=this.canvasData;b4=Number(b4);if(b4<0){b4=1/(1-b4)}else{b4=1+b4}return this.zoomTo(b3.width*b4/b3.naturalWidth,null,b2)},zoomTo:function aU(b9,cd,ca){var cf=this.options,b6=this.canvasData;var b4=b6.width,ce=b6.height,b8=b6.naturalWidth,cb=b6.naturalHeight;b9=Number(b9);if(b9>=0&&this.ready&&!this.disabled&&cf.zoomable){var b7=b8*b9;var b3=cb*b9;if(aT(this.element,ap,{ratio:b9,oldRatio:b4/b8,originalEvent:ca})===false){return this}if(ca){var cc=this.pointers;var b5=bX(this.cropper);var b2=cc&&Object.keys(cc).length?bu(cc):{pageX:ca.pageX,pageY:ca.pageY};b6.left-=(b7-b4)*((b2.pageX-b5.left-b6.left)/b4);b6.top-=(b3-ce)*((b2.pageY-b5.top-b6.top)/ce)}else{if(w(cd)&&af(cd.x)&&af(cd.y)){b6.left-=(b7-b4)*((cd.x-b6.left)/b4);b6.top-=(b3-ce)*((cd.y-b6.top)/ce)}else{b6.left-=(b7-b4)/2;b6.top-=(b3-ce)/2}}b6.width=b7;b6.height=b3;this.renderCanvas(true)}return this},rotate:function v(b2){return this.rotateTo((this.imageData.rotate||0)+Number(b2))},rotateTo:function b0(b2){b2=Number(b2);if(af(b2)&&this.ready&&!this.disabled&&this.options.rotatable){this.imageData.rotate=b2%360;this.renderCanvas(true,true)}return this},scaleX:function W(b3){var b2=this.imageData.scaleY;return this.scale(b3,af(b2)?b2:1)},scaleY:function U(b3){var b2=this.imageData.scaleX;return this.scale(af(b2)?b2:1,b3)},scale:function aX(b4){var b2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:b4;var b5=this.imageData;var b3=false;b4=Number(b4);b2=Number(b2);if(this.ready&&!this.disabled&&this.options.scalable){if(af(b4)){b5.scaleX=b4;b3=true}if(af(b2)){b5.scaleY=b2;b3=true}if(b3){this.renderCanvas(true,true)}}return this},getData:function bg(){var b5=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var ca=this.options,b2=this.imageData,b6=this.canvasData,b4=this.cropBoxData;var b7;if(this.ready&&this.cropped){b7={x:b4.left-b6.left,y:b4.top-b6.top,width:b4.width,height:b4.height};var b8=b2.width/b2.naturalWidth;ar(b7,function(cc,cb){b7[cb]=cc/b8});if(b5){var b3=Math.round(b7.y+b7.height);var b9=Math.round(b7.x+b7.width);b7.x=Math.round(b7.x);b7.y=Math.round(b7.y);b7.width=b9-b7.x;b7.height=b3-b7.y}}else{b7={x:0,y:0,width:0,height:0}}if(ca.rotatable){b7.rotate=b2.rotate||0}if(ca.scalable){b7.scaleX=b2.scaleX||1;b7.scaleY=b2.scaleY||1}return b7},setData:function au(b7){var b4=this.options,b8=this.imageData,b3=this.canvasData;var b6={};if(this.ready&&!this.disabled&&w(b7)){var b2=false;if(b4.rotatable){if(af(b7.rotate)&&b7.rotate!==b8.rotate){b8.rotate=b7.rotate;b2=true}}if(b4.scalable){if(af(b7.scaleX)&&b7.scaleX!==b8.scaleX){b8.scaleX=b7.scaleX;b2=true}if(af(b7.scaleY)&&b7.scaleY!==b8.scaleY){b8.scaleY=b7.scaleY;b2=true}}if(b2){this.renderCanvas(true,true)}var b5=b8.width/b8.naturalWidth;if(af(b7.x)){b6.left=b7.x*b5+b3.left}if(af(b7.y)){b6.top=b7.y*b5+b3.top}if(af(b7.width)){b6.width=b7.width*b5}if(af(b7.height)){b6.height=b7.height*b5}this.setCropBoxData(b6)}return this},getContainerData:function a7(){return this.ready?ag({},this.containerData):{}},getImageData:function ad(){return this.sized?ag({},this.imageData):{}},getCanvasData:function Z(){var b2=this.canvasData;var b3={};if(this.ready){ar(["left","top","width","height","naturalWidth","naturalHeight"],function(b4){b3[b4]=b2[b4]})}return b3},setCanvasData:function c(b4){var b2=this.canvasData;var b3=b2.aspectRatio;if(this.ready&&!this.disabled&&w(b4)){if(af(b4.left)){b2.left=b4.left}if(af(b4.top)){b2.top=b4.top}if(af(b4.width)){b2.width=b4.width;b2.height=b4.width/b3}else{if(af(b4.height)){b2.height=b4.height;b2.width=b4.height*b3}}this.renderCanvas(true)}return this},getCropBoxData:function am(){var b3=this.cropBoxData;var b2;if(this.ready&&this.cropped){b2={left:b3.left,top:b3.top,width:b3.width,height:b3.height}}return b2||{}},setCropBoxData:function aR(b6){var b5=this.cropBoxData;var b3=this.options.aspectRatio;var b4;var b2;if(this.ready&&this.cropped&&!this.disabled&&w(b6)){if(af(b6.left)){b5.left=b6.left}if(af(b6.top)){b5.top=b6.top}if(af(b6.width)&&b6.width!==b5.width){b4=true;b5.width=b6.width}if(af(b6.height)&&b6.height!==b5.height){b2=true;b5.height=b6.height}if(b3){if(b4){b5.height=b5.width/b3}else{if(b2){b5.width=b5.height*b3}}}this.renderCropBox()}return this},getCroppedCanvas:function ao(){var cc=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement){return null}var ci=this.canvasData;var co=a6(this.image,this.imageData,ci,cc);if(!this.cropped){return co}var ch=this.getData(),cv=ch.x,cu=ch.y,ce=ch.width,cq=ch.height;var cg=co.width/Math.floor(ci.naturalWidth);if(cg!==1){cv*=cg;cu*=cg;ce*=cg;cq*=cg}var b4=ce/cq;var cd=bx({aspectRatio:b4,width:cc.maxWidth||Infinity,height:cc.maxHeight||Infinity});var ct=bx({aspectRatio:b4,width:cc.minWidth||0,height:cc.minHeight||0},"cover");var cf=bx({aspectRatio:b4,width:cc.width||(cg!==1?co.width:ce),height:cc.height||(cg!==1?co.height:cq)}),cn=cf.width,cm=cf.height;cn=Math.min(cd.width,Math.max(ct.width,cn));cm=Math.min(cd.height,Math.max(ct.height,cm));var cb=document.createElement("canvas");var b7=cb.getContext("2d");cb.width=bq(cn);cb.height=bq(cm);b7.fillStyle=cc.fillColor||"transparent";b7.fillRect(0,0,cn,cm);var cp=cc.imageSmoothingEnabled,b3=cp===void 0?true:cp,b9=cc.imageSmoothingQuality;b7.imageSmoothingEnabled=b3;if(b9){b7.imageSmoothingQuality=b9}var cj=co.width;var b8=co.height;var b2=cv;var cx=cu;var cl;var cs;var b6;var b5;var ca;var ck;if(b2<=-ce||b2>cj){b2=0;cl=0;b6=0;ca=0}else{if(b2<=0){b6=-b2;b2=0;cl=Math.min(cj,ce+b2);ca=cl}else{if(b2<=cj){b6=0;cl=Math.min(ce,cj-b2);ca=cl}}}if(cl<=0||cx<=-cq||cx>b8){cx=0;cs=0;b5=0;ck=0}else{if(cx<=0){b5=-cx;cx=0;cs=Math.min(b8,cq+cx);ck=cs}else{if(cx<=b8){b5=0;cs=Math.min(cq,b8-cx);ck=cs}}}var cr=[b2,cx,cl,cs];if(ca>0&&ck>0){var cw=cn/ce;cr.push(b6*cw,b5*cw,ca*cw,ck*cw)}b7.drawImage.apply(b7,[co].concat(an(cr.map(function(cy){return Math.floor(bq(cy))}))));return cb},setAspectRatio:function E(b3){var b2=this.options;if(!this.disabled&&!aP(b3)){b2.aspectRatio=Math.max(0,b3)||NaN;if(this.ready){this.initCropBox();if(this.cropped){this.renderCropBox()}}}return this},setDragMode:function ac(b7){var b2=this.options,b3=this.dragBox,b4=this.face;if(this.ready&&!this.disabled){var b6=b7===aq;var b5=b2.movable&&b7===aO;b7=b6||b5?b7:at;b2.dragMode=b7;au(b3,bp,b7);a3(b3,bA,b6);a3(b3,bZ,b5);if(!b2.cropBoxMovable){au(b4,bp,b7);a3(b4,bA,b6);a3(b4,bZ,b5)}}return this}};var Q=aw.Cropper;var R=function(){function b9(cf){var ce=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};aC(this,b9);if(!cf||!ba.test(cf.tagName)){throw new Error("The first argument is required and must be an <img> or <canvas> element.")}this.element=cf;this.options=ag({},V,w(ce)&&ce);this.cropped=false;this.disabled=false;this.pointers={};this.ready=false;this.reloading=false;this.replaced=false;this.sized=false;this.sizing=false;this.init()}a8(b9,[{key:"init",value:function cc(){var cg=this.element;var cf=cg.tagName.toLowerCase();var ce;if(cg[M]){return}cg[M]=this;if(cf==="img"){this.isImg=true;ce=cg.getAttribute("src")||"";this.originalUrl=ce;if(!ce){return}ce=cg.src}else{if(cf==="canvas"&&window.HTMLCanvasElement){ce=cg.toDataURL()}}this.load(ce)}},{key:"load",value:function cb(cf){var cj=this;if(!cf){return}this.url=cf;this.imageData={};var cg=this.element,ce=this.options;if(!ce.rotatable&&!ce.scalable){ce.checkOrientation=false}if(!ce.checkOrientation||!window.ArrayBuffer){this.clone();return}if(a9.test(cf)){if(bF.test(cf)){this.read(aF(cf))}else{this.clone()}return}var ch=new XMLHttpRequest();var ci=this.clone.bind(this);this.reloading=true;this.xhr=ch;ch.onabort=ci;ch.onerror=ci;ch.ontimeout=ci;ch.onprogress=function(){if(ch.getResponseHeader("content-type")!==aJ){ch.abort()}};ch.onload=function(){cj.read(ch.response)};ch.onloadend=function(){cj.reloading=false;cj.xhr=null};if(ce.checkCrossOrigin&&bk(cf)&&cg.crossOrigin){cf=bR(cf)}ch.open("GET",cf,true);ch.responseType="arraybuffer";ch.withCredentials=cg.crossOrigin==="use-credentials";ch.send()}},{key:"read",value:function b4(cj){var ci=this.options,cl=this.imageData;var cf=y(cj);var ch=0;var cg=1;var ce=1;if(cf>1){this.url=aa(cj,aJ);var ck=k(cf);ch=ck.rotate;cg=ck.scaleX;ce=ck.scaleY}if(ci.rotatable){cl.rotate=ch}if(ci.scalable){cl.scaleX=cg;cl.scaleY=ce}this.clone()}},{key:"clone",value:function b7(){var cg=this.element,cf=this.url;var ce=cg.crossOrigin;var ch=cf;if(this.options.checkCrossOrigin&&bk(cf)){if(!ce){ce="anonymous"}ch=bR(cf)}this.crossOrigin=ce;this.crossOriginUrl=ch;var ci=document.createElement("img");if(ce){ci.crossOrigin=ce}ci.src=ch||cf;ci.alt=cg.alt||"The image to crop";this.image=ci;ci.onload=this.start.bind(this);ci.onerror=this.stop.bind(this);x(ci,aj);cg.parentNode.insertBefore(ci,cg.nextSibling)}},{key:"start",value:function b3(){var ch=this;var cj=this.image;cj.onload=null;cj.onerror=null;this.sizing=true;var cg=aw.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(aw.navigator.userAgent);var cf=function cf(ck,cl){ag(ch.imageData,{naturalWidth:ck,naturalHeight:cl,aspectRatio:ck/cl});ch.initialImageData=ag({},ch.imageData);ch.sizing=false;ch.sized=true;ch.build()};if(cj.naturalWidth&&!cg){cf(cj.naturalWidth,cj.naturalHeight);return}var ci=document.createElement("img");var ce=document.body||document.documentElement;this.sizingImage=ci;ci.onload=function(){cf(ci.width,ci.height);if(!cg){ce.removeChild(ci)}};ci.src=cj.src;if(!cg){ci.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;";ce.appendChild(ci)}}},{key:"stop",value:function b8(){var ce=this.image;ce.onload=null;ce.onerror=null;ce.parentNode.removeChild(ce);this.image=null}},{key:"build",value:function ca(){if(!this.sized||this.ready){return}var ck=this.element,cn=this.options,ch=this.image;var cf=ck.parentNode;var cm=document.createElement("div");cm.innerHTML=al;var ce=cm.querySelector(".".concat(M,"-container"));var cg=ce.querySelector(".".concat(M,"-canvas"));var cj=ce.querySelector(".".concat(M,"-drag-box"));var ci=ce.querySelector(".".concat(M,"-crop-box"));var cl=ci.querySelector(".".concat(M,"-face"));this.container=cf;this.cropper=ce;this.canvas=cg;this.dragBox=cj;this.cropBox=ci;this.viewBox=ce.querySelector(".".concat(M,"-view-box"));this.face=cl;cg.appendChild(ch);x(ck,g);cf.insertBefore(ce,ck.nextSibling);if(!this.isImg){a5(ch,aj)}this.initPreview();this.bind();cn.initialAspectRatio=Math.max(0,cn.initialAspectRatio)||NaN;cn.aspectRatio=Math.max(0,cn.aspectRatio)||NaN;cn.viewMode=Math.max(0,Math.min(3,Math.round(cn.viewMode)))||0;x(ci,g);if(!cn.guides){x(ci.getElementsByClassName("".concat(M,"-dashed")),g)}if(!cn.center){x(ci.getElementsByClassName("".concat(M,"-center")),g)}if(cn.background){x(ce,"".concat(M,"-bg"))}if(!cn.highlight){x(cl,ai)}if(cn.cropBoxMovable){x(cl,bZ);au(cl,bp,ae)}if(!cn.cropBoxResizable){x(ci.getElementsByClassName("".concat(M,"-line")),g);x(ci.getElementsByClassName("".concat(M,"-point")),g)}this.render();this.ready=true;this.setDragMode(cn.dragMode);if(cn.autoCrop){this.crop()}this.setData(cn.data);if(n(cn.ready)){bv(ck,ak,cn.ready,{once:true})}aT(ck,ak)}},{key:"unbuild",value:function cd(){if(!this.ready){return}this.ready=false;this.unbind();this.resetPreview();this.cropper.parentNode.removeChild(this.cropper);a5(this.element,g)}},{key:"uncreate",value:function b2(){if(this.ready){this.unbuild();this.ready=false;this.cropped=false}else{if(this.sizing){this.sizingImage.onload=null;this.sizing=false;this.sized=false}else{if(this.reloading){this.xhr.onabort=null;this.xhr.abort()}else{if(this.image){this.stop()}}}}}}],[{key:"noConflict",value:function b5(){window.Cropper=Q;return b9}},{key:"setDefaults",value:function b6(ce){ag(V,w(ce)&&ce)}}]);return b9}();ag(R.prototype,Y,a,bS,a4,aN,ax);return R})));
 
